# Test against the latest version of this Node.js version
build: off

environment:
  nodejs_version: "10"

# Install scripts. (runs after repo cloning)
install:
  # Get the latest stable version of Node.js or io.js
  - ps: Install-Product node $env:nodejs_version
  # install modules
  - npm install yarn -g

# Post-install test scripts.
test_script:
  # Output useful info for debugging.
  - node --version
  - npm --version
  # run tests
  #- npm test
  - yarn global add lerna
  - lerna bootstrap
  - mkdir %HOME%\.ark\database
  - .\node_modules\.bin\cross-env ARK_ENV=test .\node_modules\.bin\jest 
    ./packages/core-webhooks/ ./packages/core-transaction-pool-mem/
    ./packages/core-test-utils/ ./packages/core-p2p/
    ./packages/core-json-rpc/ ./packages/core-forger/
    ./packages/core-error-tracker-bugsnag/ ./packages/core-debugger-cli/
    ./packages/core-container/ ./packages/core-api/ --detectOpenHandles
    --runInBand --forceExit --ci --coverage | tee test_output.txt
  
